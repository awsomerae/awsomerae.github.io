<!DOCTYPE html>

<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에이치엘비셀 비용관리시스템</title>
    <link rel="icon" href="http://192.168.0.254:5000/sharing/Ign4YpvVO" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* project newgate , prod RAEHO JEONG */

        /* 폰트 및 기본 스타일 */
        body {
            font-family: 'Nanum Gothic', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            font-size: 9pt; /* 기본 폰트 크기 */
        }
        /* 제목 폰트 크기 */
        h2, h3 {
            font-size: 2.0em; 
            font-weight: 700;
            margin-bottom: 10px;
        }

        /* 모든 텍스트 폰트 크기 9pt */
        *, input, select, button, textarea, table, th, td {
            font-size: 9pt; /* 제목 외 모든 텍스트 크기 통일 */
        }
        h2, h3 { /* 제목만 폰트 크기 예외 처리 */
            font-size: 2.0em;
        }
        .popup-content h3 { /* 팝업 제목 크기 */
            font-size: 1.2em;
        }

        .container {
            max-width: 1400px; /* 최대 너비 */
            margin: 20px auto;
            background-color: #fff;
            padding: 10px 20px; /* 좌우 여백 */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            box-sizing: border-box; /* 패딩이 너비에 포함되도록 */
        }

        /* 반응형 기본 설정 */
        /* 필요한 경우 @media 쿼리를 추가하여 특정 화면 크기에서 조절 가능 */

        .page { display: none; } /* 페이지 기본 숨김 */

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            margin-bottom: 10px;
            min-height: 50px; /* 최소 높이 */
            flex-wrap: wrap; /* 헤더 내용이 많아지면 줄바꿈 */           
        }
        .header .user-info { font-size: 0.9em; color: #555; } /* 사용자 정보는 조금 작게 */
        .header .buttons { display: flex; align-items: center; flex-wrap: wrap; justify-content: flex-end; } /* 버튼 묶음 */
        .header .buttons button {
            margin-left: 10px;
            padding: 8px 15px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            font-size: 9pt; /* 버튼 폰트 크기 */
            flex-shrink: 0; /* 버튼 크기 유지를 위해 축소되지 않도록 */
        }

        .header .buttons .action-button { background-color: #5cb85c; color: white; } /* 신규 작성/계정 생성 등 */
        .header .buttons .action-button:hover { background-color: #4cae4c; }
        .header .buttons .nav-button { background-color: #0275d8; color: white; } /* 네비게이션 버튼 */
        .header .buttons .nav-button:hover { background-color: #025aa5; }
        .header .buttons .refresh-button { background-color: #f0ad4e; color: white; } /* 새로고침 버튼 */
        .header .buttons .refresh-button:hover { background-color: #ec971f; }
        .header .buttons .delete-button { background-color: #d9534f; color: white; } /* 관리자 계정 삭제 버튼 */
        .header .buttons .delete-button:hover { background-color: #c9302c; }

        .data-section {
            height: calc(100vh - 150px); /* 헤더, 패딩 등을 고려한 높이 */
            overflow-y: auto; /* 데이터 표시 영역 스크롤 가능 */
            margin-top: 10px;
        }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #e9e9e9; cursor: pointer;} /* 행에 마우스 오버 시 색 변경 및 커서 변경 */

        /* 숫자 자릿점 표기 (우측 정렬) */
        td.numeric { text-align: right; }

        /* Popup Styles */
        .popup-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; z-index: 1000; }
        .popup-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            max-width: 800px; /* 팝업 최대 너비 */
            width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-sizing: border-box;
        }
        .popup-content h3 { margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .popup-content form {
            display: grid; /* 2열 레이아웃을 위한 Grid 사용 */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* 최소 300px 너비의 열을 자동으로 배치 */
            gap: 15px; /* 입력 필드 간 간격 */
        }

        /* 팝업 폼 내 개별 필드 컨테이너 */
        .form-group {
            display: flex;
            flex-direction: column;
        }

        .popup-content label { display: block; margin-bottom: 5px; font-weight: bold; }
        .popup-content input, .popup-content select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }

        /* 증빙 업로드 버튼 그룹 스타일 */
        .upload-button-group {
            display: flex;
            align-items: flex-end; /* 버튼을 인풋 아래쪽에 맞춤 */
            gap: 5px; /* 인풋과 버튼 사이 간격 */
            width: 100%;
        }
        .upload-button-group input[type="text"] { /* 증빙/링크 입력 필드 */
            flex-grow: 1; /* 남은 공간 차지 */
            margin-bottom: 0 !important; 
        }
        .upload-button-group button {
            /* 팝업 내 버튼은 텍스트가 짧으므로 고정 너비 대신 content에 맞추거나 flex-shrink로 조절 */
            padding: 8px 15px;
            background-color: #0275d8;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            flex-shrink: 0;
            margin-bottom: 0 !important;
            height: 34px; /* 인풋 높이에 대략 맞춤 */
        }
        .upload-button-group button:hover {
            background-color: #025aa5;
        }

        /* 팝업 하단 안내 문구 */
        .popup-instructions {
            grid-column: 1 / -1; /* 전체 너비 차지 */
            font-size: 0.9em; /* 조금 작게 */
            color: #555;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        .popup-content .button-group {
            grid-column: 1 / -1; /* 버튼 그룹을 전체 너비로 확장 */
            text-align: right;
            margin-top: 15px;
        }
        .popup-content .button-group button { /* 버튼 크기 통일 */
            padding: 10px 15px;
            margin-left: 10px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            min-width: 80px; /* 버튼 최소 너비 */
        }
        .popup-content .button-group .save-button { background-color: #5cb85c; color: white; }
        .popup-content .button-group .save-button:hover { background-color: #4cae4c; }
        .popup-content .button-group .cancel-button { background-color: #f0ad4e; color: white; }
        .popup-content .button-group .cancel-button:hover { background-color: #ec971f; }
        .popup-content .button-group .delete-button { background-color: #d9534f; color: white; }
        .popup-content .button-group .delete-button:hover { background-color: #c9302c; }

        /* Specific page styles */
        #loginPage { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background-color: #f4f4f4; padding: 20px; box-sizing: border-box;} /* 반응형 고려 패딩 */
        #loginPage .login-box { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); text-align: center; width: 100%; max-width: 400px; box-sizing: border-box;} /* 반응형 고려 최대 너비 */
        #loginPage h2 { margin-bottom: 20px; font-size: 1.8em; } /* 로그인 페이지 제목 */
        #loginPage input { width: 100%; margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        #loginPage button { width: 100%; padding: 10px; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 5px; }
        #loginPage .login-button { background-color: #5cb85c; }
        #loginPage .login-button:hover { background-color: #4cae4c; }
        #loginPage .new-account-button { background-color: #0275d8; margin-top: 10px;}
        #loginPage .new-account-button:hover { background-color: #025aa5;}

        /* Admin Page Specific */
        #adminPage .data-section table tr.selected { background-color: #cce5ff; } /* 선택된 행 배경색 */

        #accountTable {
            table-layout: fixed; /* 테이블 레이아웃을 고정하여 컬럼 너비 제어 */
            width: 100%; 
        }
        #accountTable th,
        #accountTable td {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 8px; 
            box-sizing: border-box; 
        }

        /* ID 컬럼 (첫 번째 컬럼) 너비 지정 */
        #accountTable th:nth-child(1),
        #accountTable td:nth-child(1) {
            width: 100px; 
            min-width: 80px; 
            text-align: left; 
        }

        /* password 컬럼 (두 번째 컬럼) 너비 지정 (필요 시 조정) */
        #accountTable th:nth-child(2),
        #accountTable td:nth-child(2) {
            width: 120px; 
            min-width: 100px;
        }

        /* 나머지 컬럼들은 남은 공간을 분배하거나 명시적으로 너비 지정 */
        /* 예: 소속, 성명, 직급에 남은 공간 분배 (또는 필요시 고정 너비 지정) */
        #accountTable th:nth-child(3), #accountTable td:nth-child(3),
        #accountTable th:nth-child(4), #accountTable td:nth-child(4),
        #accountTable th:nth-child(5), #accountTable td:nth-child(5) {
            width: auto; 
            min-width: 50px;
        }
        /* 마지막 컬럼에 flex-grow 속성을 줄 수도 있으나, fixed layout에서는 width/min-width 조합이 일반적 */
    </style>
</head>
<body>

    <script>
        const APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby1AX4HvtgB4zXi8y2_vXxfZ74Jh060-jFYHyD4KrfOkLQDrtA-lX8Vz0qKuNmQ6yMYSg/exec'; // <-- ⭐ 실제 웹 앱 URL로 교체하세요 ⭐
        let loggedInUser = null; // 로그인한 사용자 정보를 저장할 변수
        let currentEditingRowIndex = null; // 수정/삭제할 데이터의 Google Sheet 행 번호 (1부터 시작)
        let selectedAccountId = null; // 관리자 페이지에서 선택된 계정 ID (단일 클릭 시)
        let currentEditingAccountData = null; // 현재 수정 중인 계정 데이터를 저장할 변수

        // === Google Sheets 헤더 정의 (Apps Script 코드와 일치해야 함) ===
        const ACCOUNT_HEADERS = ['ID', 'password', '소속', '성명', '직급'];
        const PURCHASE_HEADERS = ['담당자', '구매구분', '프로젝트', '국책과제여부', '구매품의번호', '구매품의명', '품의서링크', '구매처', '물품명', '단가', '수량', '공급가', '부가세', '합계', '세금계산서일자', '비고', '증빙'];
        const EXPENSE_HEADERS = ['담당자', '일자', '비목', '사용처', '적요', '공급가', '부가세', '합계', '비고' , '증빙'];

        // 숫자 자릿점 포맷팅 함수
        function formatNumberWithCommas(number) {
            if (number === null || number === undefined || isNaN(number)) {
                return ''; // 숫자가 아니면 빈 문자열 반환
            }
            try {
                return parseInt(number).toLocaleString('en-US');
            } catch (e) {
                console.error("Error formatting number:", number, e);
                return number; // 포맷팅 실패 시 원본 값 반환
            }
        }

        // === 페이지 전환 함수 ===
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            const pageElement = document.getElementById(pageId);

            if (pageId === 'loginPage') {
                pageElement.style.display = 'flex'; // 로그인 페이지는 flex로 표시
            } else {
                pageElement.style.display = 'block'; // 다른 페이지들은 block으로 표시
            }
            if (pageId === 'purchasePage' && loggedInUser) {
                loadPurchaseData();
            } else if (pageId === 'expensePage' && loggedInUser) {
                loadExpenseData();
            } else if (pageId === 'adminPage' && loggedInUser && loggedInUser.isAdmin) {
                loadAccountData();
            }
        }

        // === 팝업 제어 함수 ===
        function showPopup(popupId) {
            document.getElementById(popupId).style.display = 'flex';
        }

        function closePopup(popupId) {
            document.getElementById(popupId).style.display = 'none';
        }

        function showInfoPopup(message) {
            document.getElementById('infoPopupMessage').innerText = message;
            showPopup('infoPopup');
        }

        // === API 요청 함수 ===
        async function sendRequest(action, payload = {}) {
            const requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'text/plain;charset=utf-8',
                },
                body: JSON.stringify({ action: action, payload: payload })
            };

            try {
                const response = await fetch(APPS_SCRIPT_WEB_APP_URL, requestOptions);
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('HTTP error', response.status, errorText);
                    return { status: 'error', message: `HTTP 오류: ${response.status}. 자세한 내용은 콘솔을 확인하세요.` };
                }
                const data = await response.json();
                console.log('API Response:', data);
                return data;
            } catch (error) {
                console.error('API Request Error:', error);
                return { status: 'error', message: `네트워크 오류가 발생했습니다: ${error.message}. Apps Script URL 또는 배포 설정을 확인하세요.` };
            }
        }

        // === 로그인 페이지 로직 ===
        async function handleLogin() {
            const idInput = document.getElementById('loginId');
            const passwordInput = document.getElementById('loginPassword');
            const id = idInput.value;
            const password = passwordInput.value;

            if (!id || !password) {
                showInfoPopup('ID와 비밀번호를 입력해주세요.');
                return;
            }

            const response = await sendRequest('login', { id: id, password: password });

            if (response.status === 'success') {
                loggedInUser = response.user;
                console.log('로그인 성공:', loggedInUser);

                if (loggedInUser.isAdmin) {
                    showPage('adminPage');
                } else {
                    showPage('purchasePage');
                }
            } else {
                showInfoPopup(response.message);
            }
        }

        addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                handleLogin();
            }
        });

        function openNewAccountPopup() {
            document.getElementById('newAccountId').value = '';
            document.getElementById('newUserPassword').value = '';
            document.getElementById('newUserAffiliation').value = '';
            document.getElementById('newUserName').value = '';
            document.getElementById('newUserPosition').value = '';
            showPopup('newUserPopup');
        }

        async function handleCreateNewAccount() {
            const id = document.getElementById('newAccountId').value;
            const password = document.getElementById('newUserPassword').value;
            const affiliation = document.getElementById('newUserAffiliation').value;
            const name = document.getElementById('newUserName').value;
            const position = document.getElementById('newUserPosition').value;

            if (!id || !password || !name) {
                showInfoPopup('ID, 비밀번호, 성명은 필수 입력 항목입니다.');
                return;
            }

            const response = await sendRequest('createUser', {
                ID: id,
                password: password,
                소속: affiliation,
                성명: name,
                직급: position
            });

            if (response.status === 'success') {
                showInfoPopup(response.message);
                closePopup('newUserPopup');
                if (loggedInUser && loggedInUser.isAdmin && document.getElementById('adminPage').style.display === 'block') {
                    document.getElementById('infoPopupOkButton').onclick = () => {
                        closePopup('infoPopup');
                        loadAccountData(); 
                    };
                }
            } else {
                showInfoPopup(response.message);
            }
        }

        // === 데이터 로드 및 테이블 표시 함수 ===
        function displayDataInTable(data, tableId, headers, editable = false) {
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';

            if (!data || data.length === 0) {
                const row = tableBody.insertRow();
                const cell = row.insertCell();
                cell.colSpan = headers.length;
                cell.innerText = '데이터가 없습니다.';
                cell.style.textAlign = 'center';
                return;
            }

            const numericCols = (tableId === 'purchaseTable')
                ? ['단가', '수량', '공급가', '부가세', '합계']
                : (tableId === 'expenseTable')
                    ? ['공급가', '부가세', '합계']
                    : [];

            data.forEach(rowData => {
                const row = tableBody.insertRow();
                row.dataset.rowIndex = rowData.rowIndex; 

                headers.forEach(header => {
                    const cell = row.insertCell();
                    let cellValue = rowData[header] === undefined ? '' : rowData[header];

                    if (numericCols.includes(header) && cellValue !== '') {
                        cellValue = formatNumberWithCommas(cellValue);
                        cell.classList.add('numeric');
                    } else if ((header === '세금계산서일자' || header === '일자') && cellValue) {
                        try {
                            const dateObj = new Date(cellValue);
                            if (!isNaN(dateObj.getTime())) {
                                const year = dateObj.getFullYear();
                                const month = String(dateObj.getMonth() + 1).padStart(2, '0');
                                const day = String(dateObj.getDate()).padStart(2, '0');
                                cellValue = `${year}-${month}-${day}`;
                            }
                        } catch (e) {
                            console.warn("Failed to parse date:", cellValue, e);
                        }
                    }

                    if (header === '품의서링크' || header === '증빙') {
                        if (cellValue) { 
                            const link = document.createElement('a');
                            link.href = cellValue; 
                            link.innerText = '링크'; 
                            
                            link.onclick = function(event) {
                                event.preventDefault(); 
                                event.stopPropagation(); 
                                window.open(this.href, '_blank', 'width=800,height=600,resizable=yes,scrollbars=yes');
                            };
                            cell.innerHTML = ''; 
                            cell.appendChild(link);
                        } else {
                            cell.innerText = '-'; 
                        }
                    } else {
                        cell.innerText = cellValue;
                    }
                });

                if (editable) { 
                    row.ondblclick = () => openEditPopup(tableId, rowData);
                } else if (tableId === 'accountTable') { 
                    row.dataset.userId = rowData.ID; 
                    row.ondblclick = () => openEditAccountPopup(rowData); 
                }
            });
        }

        // 데이터 로드 (구매)
        async function loadPurchaseData() {
            if (!loggedInUser) return;
            const response = await sendRequest('getPurchaseData', {
                userName: loggedInUser.name, 
                isAdmin: loggedInUser.isAdmin
            });

            if (response.status === 'success') {
                displayDataInTable(response.data, 'purchaseTable', PURCHASE_HEADERS, true);
            } else {
                showInfoPopup('구매 관리 데이터를 불러오는데 실패했습니다: ' + response.message);
                displayDataInTable([], 'purchaseTable', PURCHASE_HEADERS, true);
            }
        }

        // 데이터 로드 (개인 경비)
        async function loadExpenseData() {
            if (!loggedInUser) return;
            const response = await sendRequest('getExpenseData', {
                userName: loggedInUser.name, 
                isAdmin: loggedInUser.isAdmin
            });

            if (response.status === 'success') {
                displayDataInTable(response.data, 'expenseTable', EXPENSE_HEADERS, true);
            } else {
                showInfoPopup('개인 경비 데이터를 불러오는데 실패했습니다: ' + response.message);
                displayDataInTable([], 'expenseTable', EXPENSE_HEADERS, true);
            }
        }

        // 관리자 페이지: 계정 정보 로드
        async function loadAccountData() {
            if (!loggedInUser || !loggedInUser.isAdmin) return;
            const response = await sendRequest('getAccounts', { isAdmin: true });

            if (response.status === 'success') {
                displayDataInTable(response.accounts, 'accountTable', ACCOUNT_HEADERS, false);
            } else {
                showInfoPopup('계정 정보를 불러오는데 실패했습니다: ' + response.message);
                displayDataInTable([], 'accountTable', ACCOUNT_HEADERS, false);
            }
        }

        // === 합계 자동 계산을 위한 함수 ===
        function setupSumCalculation(supplyPriceId, vatId, sumId) {
            const supplyPriceInput = document.getElementById(supplyPriceId);
            const vatInput = document.getElementById(vatId);
            const sumInput = document.getElementById(sumId);

            function calculateSum() {
                const supplyPrice = parseFloat(supplyPriceInput.value) || 0;
                const vat = parseFloat(vatInput.value) || 0;
                sumInput.value = supplyPrice + vat;
            }

            if (supplyPriceInput && vatInput && sumInput) {
                supplyPriceInput.addEventListener('input', calculateSum);
                vatInput.addEventListener('input', calculateSum);
            }
        }

        // === 새 데이터 작성 팝업 로직 ===
        function openNewEntryPopup(type) { 
            currentEditingRowIndex = null; 
            const popupId = type === 'purchase' ? 'newPurchasePopup' : 'newExpensePopup';
            const form = document.querySelector(`#${popupId} form`);
            form.reset();

            if (loggedInUser && form.elements['담당자']) {
                form.elements['담당자'].value = loggedInUser.name; 
                form.elements['담당자'].readOnly = true;
            }

            if (type === 'purchase') {
                setupSumCalculation('newPurchase_공급가', 'newPurchase_부가세', 'newPurchase_합계');
                const supplyInput = document.getElementById('newPurchase_공급가');
                if (supplyInput) supplyInput.dispatchEvent(new Event('input')); // 초기 계산
            } else if (type === 'expense') {
                setupSumCalculation('newExpense_공급가', 'newExpense_부가세', 'newExpense_합계');
                const supplyInput = document.getElementById('newExpense_공급가');
                if (supplyInput) supplyInput.dispatchEvent(new Event('input')); // 초기 계산
            }
            showPopup(popupId);
        }

        // === 수정/삭제 팝업 로직 ===
        function openEditPopup(tableId, rowData) {
            currentEditingRowIndex = rowData.rowIndex;

            let popupId;
            let headers;
            let form;

            if (tableId === 'purchaseTable') {
                popupId = 'editPurchasePopup';
                headers = PURCHASE_HEADERS;
                form = document.querySelector('#editPurchasePopup form');
            } else if (tableId === 'expenseTable') {
                popupId = 'editExpensePopup';
                headers = EXPENSE_HEADERS;
                form = document.querySelector('#editExpensePopup form');
            } else {
                console.error('Unknown table ID for edit popup:', tableId);
                return;
            }

            headers.forEach(header => {
                const input = form.elements[header];
                if (input) {
                    if ((header === '세금계산서일자' || header === '일자') && rowData[header]) {
                        try {
                            const dateObj = new Date(rowData[header]);
                            if (!isNaN(dateObj.getTime())) {
                                const year = dateObj.getFullYear();
                                const month = String(dateObj.getMonth() + 1).padStart(2, '0');
                                const day = String(dateObj.getDate()).padStart(2, '0');
                                input.value = `${year}-${month}-${day}`;
                            } else {
                                input.value = String(rowData[header]);
                            }
                        } catch (e) {
                            console.warn("Failed to set date input value:", rowData[header], e);
                            input.value = String(rowData[header]);
                        }
                   } else {
                        input.value = rowData[header] === undefined ? '' : rowData[header];
                   }

                    if (header === '담당자') {
                        input.readOnly = true;
                    } else {
                        input.readOnly = false;
                    }
                }
            });
            showPopup(popupId);
        }

        async function handleSaveData(type) { 
            const popupId = type === 'purchase' ? (currentEditingRowIndex ? 'editPurchasePopup' : 'newPurchasePopup') : (currentEditingRowIndex ? 'editExpensePopup' : 'newExpensePopup');
            const form = document.querySelector(`#${popupId} form`);

            const dataObject = {};
            const headers = type === 'purchase' ? PURCHASE_HEADERS : EXPENSE_HEADERS;

            headers.forEach(header => {
                const input = form.elements[header];
                if (input) {
                    dataObject[header] = input.value;
                } else {
                    if (header === '담당자' && loggedInUser) {
                        dataObject[header] = loggedInUser.name;
                    } else {
                       dataObject[header] = '';
                    }
                }
            });

            let response;
            if (currentEditingRowIndex) {
                const action = type === 'purchase' ? 'updatePurchase' : 'updateExpense';
                response = await sendRequest(action, { rowIndex: currentEditingRowIndex, [type + 'Data']: dataObject });
            } else {
                const action = type === 'purchase' ? 'createPurchase' : 'createExpense';
                response = await sendRequest(action, { [type + 'Data']: dataObject });
            }

            if (response.status === 'success') {
                showInfoPopup(response.message);
                closePopup(popupId);
                const reloadFunction = type === 'purchase' ? loadPurchaseData : loadExpenseData;
                document.getElementById('infoPopupOkButton').onclick = () => {
                    closePopup('infoPopup');
                    reloadFunction();
                };
            } else {
                showInfoPopup(response.message);
            }
        }

        function handleDeleteConfirmation(type) { 
            if (!currentEditingRowIndex) {
                showInfoPopup('삭제할 항목이 선택되지 않았습니다.');
                return;
            }
            document.getElementById('confirmDeleteMessage').innerText = '정말 이 항목을 삭제하시겠습니까?';
            showPopup('confirmDeletePopup');

            document.getElementById('confirmDeleteOkButton').onclick = () => handleDeleteData(type);
            document.getElementById('confirmDeleteCancelButton').onclick = () => closePopup('confirmDeletePopup');
        }

        async function handleDeleteData(type) { 
            if (!currentEditingRowIndex) {
                showInfoPopup('삭제할 항목이 없습니다.');
                closePopup('confirmDeletePopup');
                return;
            }

            closePopup('confirmDeletePopup');

            const action = type === 'purchase' ? 'deletePurchase' : 'deleteExpense';
            const response = await sendRequest(action, { rowIndex: currentEditingRowIndex });

            if (response.status === 'success') {
                showInfoPopup(response.message);
                const reloadFunction = type === 'purchase' ? loadPurchaseData : loadExpenseData;
                document.getElementById('infoPopupOkButton').onclick = () => {
                    closePopup('infoPopup');
                    reloadFunction();
                };
                const editPopupId = type === 'purchase' ? 'editPurchasePopup' : 'editExpensePopup';
                closePopup(editPopupId);
            } else {
                showInfoPopup(response.message);
            }
            currentEditingRowIndex = null;
        }

        // === 관리자 페이지 로직 (계정 관련) ===
        function handleAccountRowClick(event) {
            document.querySelectorAll('#accountTable tbody tr').forEach(row => {
                row.classList.remove('selected');
            });

            const clickedRow = event.target.closest('tr');
            if (clickedRow) {
                clickedRow.classList.add('selected');
                selectedAccountId = clickedRow.dataset.userId;
                console.log('Selected Account ID (single click):', selectedAccountId);
            } else {
                selectedAccountId = null;
            }
        }

        // === 계정 정보 수정/삭제 팝업 로직 ===
        function openEditAccountPopup(rowData) {
            currentEditingAccountData = rowData; 
            currentEditingRowIndex = rowData.rowIndex; 

            const form = document.querySelector('#editAccountPopup form');
            form.elements['ID'].value = rowData.ID || '';
            form.elements['password'].value = ''; 
            form.elements['password'].placeholder = '새 비밀번호 (변경 시에만 입력)';
            form.elements['소속'].value = rowData.소속 || '';
            form.elements['성명'].value = rowData.성명 || '';
            form.elements['직급'].value = rowData.직급 || '';

            showPopup('editAccountPopup');
        }

        async function handleSaveAccountData() {
            if (!currentEditingAccountData) {
                showInfoPopup('수정할 계정 정보가 없습니다.');
                return;
            }

            const form = document.querySelector('#editAccountPopup form');
            const newPassword = form.elements['password'].value;

            if (!form.elements['성명'].value) {
                showInfoPopup('성명은 필수 입력 항목입니다.');
                return;
            }

            const accountData = {
                소속: form.elements['소속'].value,
                성명: form.elements['성명'].value,
                직급: form.elements['직급'].value
            };

            if (newPassword && newPassword.length > 0) {
                accountData.password = newPassword;
            }

            const payload = {
                userId: currentEditingAccountData.ID,
                accountData: accountData
            };
            if (currentEditingRowIndex) { 
                payload.rowIndex = currentEditingRowIndex;
            }
            
            const response = await sendRequest('updateAccount', payload); 

            if (response.status === 'success') {
                showInfoPopup(response.message);
                closePopup('editAccountPopup');
                document.getElementById('infoPopupOkButton').onclick = () => {
                    closePopup('infoPopup');
                    loadAccountData();
                };
            } else {
                showInfoPopup(response.message);
            }
            currentEditingAccountData = null; 
            currentEditingRowIndex = null;
        }

        function handleDeleteConfirmationForAccount() {
            if (!currentEditingAccountData || !currentEditingAccountData.ID) {
                showInfoPopup('삭제할 계정이 선택되지 않았습니다.');
                return;
            }
            if (loggedInUser && loggedInUser.ID === currentEditingAccountData.ID) {
                showInfoPopup('자기 자신의 계정은 삭제할 수 없습니다.');
                return;
            }

            document.getElementById('confirmDeleteMessage').innerText = `ID "${currentEditingAccountData.ID}" 계정을 정말 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`;
            showPopup('confirmDeletePopup');

            document.getElementById('confirmDeleteOkButton').onclick = () => executeAccountDeletion();
            document.getElementById('confirmDeleteCancelButton').onclick = () => {
                closePopup('confirmDeletePopup');
            };
        }

        async function executeAccountDeletion() {
            if (!currentEditingAccountData || !currentEditingAccountData.ID) {
                showInfoPopup('삭제할 계정 정보가 없습니다.');
                closePopup('confirmDeletePopup');
                return;
            }
            if (loggedInUser && loggedInUser.ID === currentEditingAccountData.ID) {
                showInfoPopup('자기 자신의 계정은 삭제할 수 없습니다.');
                closePopup('confirmDeletePopup');
                currentEditingAccountData = null; 
                currentEditingRowIndex = null;
                return;
            }

            closePopup('confirmDeletePopup'); 

            const response = await sendRequest('deleteAccount', {
                userId: currentEditingAccountData.ID,
                isAdmin: true 
            });

            if (response.status === 'success') {
                showInfoPopup(response.message);
                closePopup('editAccountPopup'); 
                document.getElementById('infoPopupOkButton').onclick = () => {
                    closePopup('infoPopup');
                    loadAccountData();
                };
            } else {
                showInfoPopup(response.message);
            }
            currentEditingAccountData = null; 
            currentEditingRowIndex = null;
        }

        // 증빙 업로드 버튼 클릭 시 새 창 열기
        function openUploadFolder(folderUrl) {
            window.open(folderUrl, '_blank', 'width=800,height=600,resizable=yes,scrollbars=yes');
        }

        // === 페이지 로드 시 초기화 ===
        window.onload = () => {
            showPage('loginPage');

            const accountTableBody = document.querySelector('#accountTable tbody');
            if (accountTableBody) {
                accountTableBody.addEventListener('click', handleAccountRowClick); // 단일 클릭 이벤트
            } else {
                console.error("Account table tbody not found!");
            }

            document.querySelectorAll('button:not(#loginPage button, .upload-button-group button)').forEach(button => {
                button.classList.add('app-button');
            });
        };

    </script>

    <div id="loginPage" class="page">
        <div class="login-box">
            <h2>에이치엘비셀 비용관리시스템 로그인</h2>
            <input type="text" id="loginId" placeholder="ID">
            <input type="password" id="loginPassword" placeholder="Password">
            <button class="login-button" onclick="handleLogin()">로그인</button>
            <button class="new-account-button" onclick="openNewAccountPopup()">신규 계정 생성</button>
        </div>
    </div>

    <div id="purchasePage" class="page container">
        <div class="header">
            <div>
                <h2>구매관리</h2>
                <div class="user-info">
                    <span id="purchase-user-info"></span>
                </div>
            </div>
            <div class="buttons">
                <button class="action-button" onclick="openNewEntryPopup('purchase')">신규 작성</button>
                <button class="refresh-button" onclick="loadPurchaseData()">새로고침</button>
                <button class="nav-button" onclick="showPage('purchasePage')">구매관리</button> 
                <button class="nav-button" onclick="showPage('expensePage')">개인경비관리</button> 
            </div>
        </div>
        <div class="data-section">
            <table id="purchaseTable">
                <thead>
                    <tr>
                        <th>담당자</th><th>구매구분</th><th>프로젝트</th><th>국책과제여부</th><th>구매품의번호</th><th>구매품의명</th><th>품의서링크</th><th>구매처</th><th>물품명</th><th>단가</th><th>수량</th><th>공급가</th><th>부가세</th><th>합계</th><th>세금계산서일자</th><th>비고</th><th>증빙</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <div id="expensePage" class="page container">
        <div class="header">
            <div>
                <h2>개인경비관리</h2>
                <div class="user-info">
                    <span id="expense-user-info"></span>
                </div>
            </div>
            <div class="buttons">
                <button class="action-button" onclick="openNewEntryPopup('expense')">신규 작성</button>
                <button class="refresh-button" onclick="loadExpenseData()">새로고침</button>
                <button class="nav-button" onclick="showPage('purchasePage')">구매관리</button> 
                <button class="nav-button" onclick="showPage('expensePage')">개인경비관리</button> 
            </div>
        </div>
        <div class="data-section">
            <table id="expenseTable">
                <thead>
                    <tr>
                        <th>담당자</th><th>일자</th><th>비목</th><th>사용처</th><th>적요</th><th>공급가</th><th>부가세</th><th>합계</th><th>비고</th><th>증빙</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <div id="adminPage" class="page container">
        <div class="header">
            <div>
                <h2>관리자 페이지</h2>
                <div class="user-info">
                    <span id="admin-user-info"></span>
                </div>
            </div>
            <div class="buttons">
                <button class="action-button admin-create-button" onclick="openNewAccountPopup()">계정 생성</button>
                <button class="refresh-button" onclick="loadAccountData()">새로고침</button>
                <button class="nav-button" onclick="showPage('purchasePage')">구매관리</button>
                <button class="nav-button" onclick="showPage('expensePage')">개인경비관리</button>
            </div>
        </div>
        <div class="data-section">
            <table id="accountTable">
                <thead>
                    <tr>
                        <th>ID</th><th>password</th><th>소속</th><th>성명</th><th>직급</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <div id="newUserPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>신규계정 생성</h3>
            <form>
                <div class="form-group"><label for="newAccountId">ID:</label><input type="text" id="newAccountId" name="ID" required></div>
                <div class="form-group"><label for="newUserPassword">Password:</label><input type="password" id="newUserPassword" name="password" required></div>
                <div class="form-group"><label for="newUserAffiliation">소속:</label><input type="text" id="newUserAffiliation" name="소속"></div>
                <div class="form-group"><label for="newUserName">성명:</label><input type="text" id="newUserName" name="성명" required></div>
                <div class="form-group"><label for="newUserPosition">직급:</label><input type="text" id="newUserPosition" name="직급"></div>

                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleCreateNewAccount()">SAVE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('newUserPopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="newPurchasePopup" class="popup-overlay">
        <div class="popup-content">
            <h3>신규 구매항목 작성</h3>
            <form>
                <div class="form-group"><label for="newPurchase_담당자">담당자:</label><input type="text" id="newPurchase_담당자" name="담당자" readonly></div>
                <div class="form-group">
                    <label for="newPurchase_구매구분">구매구분:</label>
                    <select id="newPurchase_구매구분" name="구매구분">
                        <option value="재료">재료</option>
                        <option value="장비">장비</option>
                        <option value="비품">비품</option>
                        <option value="소모품">소모품</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newPurchase_프로젝트">프로젝트:</label>
                    <select id="newPurchase_프로젝트" name="프로젝트">
                        <option value="세포외기질">세포외기질</option>
                        <option value="지혈제">지혈제</option>
                        <option value="인공간">인공간</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newPurchase_국책과제여부">국책과제여부:</label>
                    <select id="newPurchase_국책과제여부" name="국책과제여부">
                        <option value="일반">일반</option>
                        <option value="국책과제">국책과제</option>
                    </select>
                </div>
                <div class="form-group"><label for="newPurchase_구매품의번호">구매품의번호:</label><input type="text" id="newPurchase_구매품의번호" name="구매품의번호"></div>
                <div class="form-group"><label for="newPurchase_구매품의명">구매품의명:</label><input type="text" id="newPurchase_구매품의명" name="구매품의명"></div>
                <div class="form-group">
                    <label for="newPurchase_품의서링크">품의서링크:</label>
                    <input type="text" id="newPurchase_품의서링크" name="품의서링크">
                </div>
                <div class="form-group"><label for="newPurchase_구매처">구매처:</label><input type="text" id="newPurchase_구매처" name="구매처"></div>
                <div class="form-group"><label for="newPurchase_물품명">물품명:</label><input type="text" id="newPurchase_물품명" name="물품명"></div>
                <div class="form-group"><label for="newPurchase_단가">단가:</label><input type="number" id="newPurchase_단가" name="단가"></div>
                <div class="form-group"><label for="newPurchase_수량">수량:</label><input type="number" id="newPurchase_수량" name="수량"></div>
                <div class="form-group"><label for="newPurchase_공급가">공급가:</label><input type="number" id="newPurchase_공급가" name="공급가"></div>
                <div class="form-group"><label for="newPurchase_부가세">부가세:</label><input type="number" id="newPurchase_부가세" name="부가세"></div>
                <div class="form-group"><label for="newPurchase_합계">합계:</label><input type="number" id="newPurchase_합계" name="합계"></div>
                <div class="form-group"><label for="newPurchase_세금계산서일자">세금계산서일자:</label><input type="date" id="newPurchase_세금계산서일자" name="세금계산서일자"></div>
                <div class="form-group"><label for="newPurchase_비고">비고:</label><input type="text" id="newPurchase_비고" name="비고"></div>
                <div class="form-group">
                    <label for="newPurchase_증빙">증빙:</label>
                    <div class="upload-button-group">
                        <input type="text" id="newPurchase_증빙" name="증빙">
                        <button type="button" onclick="openUploadFolder('https://drive.google.com/drive/folders/1kOGLuw3IMCot0VtjCM5AP0uGKDSW8dm9?usp=sharing')">업로드</button> 
                    </div>
                </div>
                <div class="popup-instructions">
                    <p>구매증빙의 파일명은 일자_거래처명_담당자명 (예시 250509_한국은행_정래호)으로 작성바랍니다.</p>
                    <p>증빙 업로드 후 해당파일 우클릭 &gt; 공유 &gt; 링크복사 후 링크를 증빙입력란에 입력바랍니다.</p>
                </div>
                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleSaveData('purchase')">SAVE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('newPurchasePopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editPurchasePopup" class="popup-overlay">
        <div class="popup-content">
            <h3>구매항목 수정/삭제</h3>
            <form>
                <div class="form-group"><label for="editPurchase_담당자">담당자:</label><input type="text" id="editPurchase_담당자" name="담당자" readonly></div>
                <div class="form-group"><label for="editPurchase_구매구분">구매구분:</label><input type="text" id="editPurchase_구매구분" name="구매구분"></div>
                <div class="form-group"><label for="editPurchase_프로젝트">프로젝트:</label><input type="text" id="editPurchase_프로젝트" name="프로젝트"></div>
                <div class="form-group"><label for="editPurchase_국책과제여부">국책과제여부:</label><input type="text" id="editPurchase_국책과제여부" name="국책과제여부"></div>
                <div class="form-group"><label for="editPurchase_구매품의번호">구매품의번호:</label><input type="text" id="editPurchase_구매품의번호" name="구매품의번호"></div>
                <div class="form-group"><label for="editPurchase_구매품의명">구매품의명:</label><input type="text" id="editPurchase_구매품의명" name="구매품의명"></div>
                <div class="form-group">
                    <label for="editPurchase_품의서링크">품의서링크:</label>
                    <input type="text" id="editPurchase_품의서링크" name="품의서링크">
                </div>
                <div class="form-group"><label for="editPurchase_구매처">구매처:</label><input type="text" id="editPurchase_구매처" name="구매처"></div>
                <div class="form-group"><label for="editPurchase_물품명">물품명:</label><input type="text" id="editPurchase_물품명" name="물품명"></div>
                <div class="form-group"><label for="editPurchase_단가">단가:</label><input type="number" id="editPurchase_단가" name="단가"></div>
                <div class="form-group"><label for="editPurchase_수량">수량:</label><input type="number" id="editPurchase_수량" name="수량"></div>
                <div class="form-group"><label for="editPurchase_공급가">공급가:</label><input type="number" id="editPurchase_공급가" name="공급가"></div>
                <div class="form-group"><label for="editPurchase_부가세">부가세:</label><input type="number" id="editPurchase_부가세" name="부가세"></div>
                <div class="form-group"><label for="editPurchase_합계">합계:</label><input type="number" id="editPurchase_합계" name="합계"></div>
                <div class="form-group"><label for="editPurchase_세금계산서일자">세금계산서일자:</label><input type="date" id="editPurchase_세금계산서일자" name="세금계산서일자"></div>
                <div class="form-group"><label for="editPurchase_비고">비고:</label><input type="text" id="editPurchase_비고" name="비고"></div>
                <div class="form-group">
                    <label for="editPurchase_증빙">증빙:</label>
                    <div class="upload-button-group">
                        <input type="text" id="editPurchase_증빙" name="증빙">
                        <button type="button" onclick="openUploadFolder('https://drive.google.com/drive/folders/1kOGLuw3IMCot0VtjCM5AP0uGKDSW8dm9?usp=sharing')">업로드</button> 
                    </div>
                </div>
                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleSaveData('purchase')">SAVE</button>
                    <button type="button" class="delete-button" onclick="handleDeleteConfirmation('purchase')">DELETE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('editPurchasePopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="newExpensePopup" class="popup-overlay">
        <div class="popup-content">
            <h3>신규 개인경비 작성</h3>
            <form>
                <div class="form-group"><label for="newExpense_담당자">담당자:</label><input type="text" id="newExpense_담당자" name="담당자" readonly></div>
                <div class="form-group"><label for="newExpense_일자">일자:</label><input type="date" id="newExpense_일자" name="일자"></div>
                <div class="form-group">
                    <label for="newExpense_비목">비목:</label>
                    <select id="newExpense_비목" name="비목">
                        <option value="여비교통비">여비교통비</option>
                        <option value="복리후생비">복리후생비</option>
                        <option value="소모품비">소모품비</option>
                        <option value="지급수수료">지급수수료</option>
                        <option value="통신비">통신비</option>
                        <option value="운반비">운반비</option>
                        <option value="접대비">접대비</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                <div class="form-group"><label for="newExpense_사용처">사용처:</label><input type="text" id="newExpense_사용처" name="사용처"></div>
                <div class="form-group"><label for="newExpense_적요">적요:</label><input type="text" id="newExpense_적요" name="적요"></div>
                <div class="form-group"><label for="newExpense_공급가">공급가:</label><input type="number" id="newExpense_공급가" name="공급가"></div>
                <div class="form-group"><label for="newExpense_부가세">부가세:</label><input type="number" id="newExpense_부가세" name="부가세"></div>
                <div class="form-group"><label for="newExpense_합계">합계:</label><input type="number" id="newExpense_합계" name="합계"></div>
                <div class="form-group"><label for="newExpense_비고">비고:</label><input type="text" id="newExpense_비고" name="비고"></div>
                <div class="form-group">
                    <label for="newExpense_증빙">증빙:</label>
                    <div class="upload-button-group">
                        <input type="text" id="newExpense_증빙" name="증빙">
                        <button type="button" onclick="openUploadFolder('https://drive.google.com/drive/folders/1VJhUETiHdxF7wRifLrVljeIhP2lVnHVJ?usp=sharing')">업로드</button> 
                    </div>
                </div>
                <div class="popup-instructions">
                    <p>경비증빙의 파일명은 일자_해당월 개인경비_담당자명 (예시 250509_2025년05월 개인경비_정래호)으로 작성바랍니다.</p>
                    <p>증빙 업로드 후 해당파일 우클릭 &gt; 공유 &gt; 링크복사 후 링크를 증빙입력란에 입력바랍니다.</p>
                </div>
                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleSaveData('expense')">SAVE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('newExpensePopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editExpensePopup" class="popup-overlay">
        <div class="popup-content">
            <h3>개인경비 수정/삭제</h3>
            <form>
                <div class="form-group"><label for="editExpense_담당자">담당자:</label><input type="text" id="editExpense_담당자" name="담당자" readonly></div>
                <div class="form-group"><label for="editExpense_일자">일자:</label><input type="date" id="editExpense_일자" name="일자"></div>
                <div class="form-group"><label for="editExpense_비목">비목:</label><input type="text" id="editExpense_비목" name="비목"></div>
                <div class="form-group"><label for="editExpense_사용처">사용처:</label><input type="text" id="editExpense_사용처" name="사용처"></div>
                <div class="form-group"><label for="editExpense_적요">적요:</label><input type="text" id="editExpense_적요" name="적요"></div>
                <div class="form-group"><label for="editExpense_공급가">공급가:</label><input type="number" id="editExpense_공급가" name="공급가"></div>
                <div class="form-group"><label for="editExpense_부가세">부가세:</label><input type="number" id="editExpense_부가세" name="부가세"></div>
                <div class="form-group"><label for="editExpense_합계">합계:</label><input type="number" id="editExpense_합계" name="합계"></div>
                <div class="form-group"><label for="editExpense_비고">비고:</label><input type="text" id="editExpense_비고" name="비고"></div>
                <div class="form-group">
                    <label for="editExpense_증빙">증빙:</label>
                    <div class="upload-button-group">
                        <input type="text" id="editExpense_증빙" name="증빙">
                        <button type="button" onclick="openUploadFolder('https://drive.google.com/drive/folders/1VJhUETiHdxF7wRifLrVljeIhP2lVnHVJ?usp=sharing')">업로드</button> 
                    </div>
                </div>
                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleSaveData('expense')">SAVE</button>
                    <button type="button" class="delete-button" onclick="handleDeleteConfirmation('expense')">DELETE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('editExpensePopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editAccountPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>계정정보 수정/삭제</h3>
            <form>
                <div class="form-group"><label for="editAccount_ID">ID:</label><input type="text" id="editAccount_ID" name="ID" readonly></div>
                <div class="form-group"><label for="editAccount_password">Password:</label><input type="password" id="editAccount_password" name="password" placeholder="새 비밀번호 (변경 시에만 입력)"></div>
                <div class="form-group"><label for="editAccount_소속">소속:</label><input type="text" id="editAccount_소속" name="소속"></div>
                <div class="form-group"><label for="editAccount_성명">성명:</label><input type="text" id="editAccount_성명" name="성명"></div>
                <div class="form-group"><label for="editAccount_직급">직급:</label><input type="text" id="editAccount_직급" name="직급"></div>
                <div class="button-group">
                    <button type="button" class="save-button" onclick="handleSaveAccountData()">SAVE</button>
                    <button type="button" class="delete-button" onclick="handleDeleteConfirmationForAccount()">DELETE</button>
                    <button type="button" class="cancel-button" onclick="closePopup('editAccountPopup')">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <div id="confirmDeletePopup" class="popup-overlay">
        <div class="popup-content">
            <h3>삭제 확인</h3>
            <p id="confirmDeleteMessage"></p>
            <div class="button-group">
                <button type="button" id="confirmDeleteOkButton" class="delete-button">확인</button>
                <button type="button" id="confirmDeleteCancelButton" class="cancel-button">취소</button>
            </div>
        </div>
    </div>

    <div id="infoPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>알림</h3>
            <p id="infoPopupMessage"></p>
            <div class="button-group">
                <button type="button" id="infoPopupOkButton" class="save-button" onclick="closePopup('infoPopup')">확인</button>
            </div>
        </div>
    </div>
    
</body>
</html>
